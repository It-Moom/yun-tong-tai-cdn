import{B as a,z as e,n as t,a9 as i,t as l,Y as n,l as s}from"./vendor.23ac6402.js";import{t as o,u as r,i as d,B as p}from"./index.5b057536.js";import{i as c}from"./mobile.d11c903b.js";import{c as m,d as g}from"./dict.303abe52.js";import{_ as u}from"./index.2d909197.js";import{n as f}from"./index.43b2460d.js";import"./index.esm.3b94485e.js";var h=function(){var l=this,n=l.$createElement,s=l._self._c||n;return s("div",{staticClass:"page-container root white rounded-lg fill-height"},[s("div",{staticClass:"search d-flex pa-2"},[s(a),s(e,{attrs:{color:"primary",height:"32"},on:{click:function(a){return l.$refs.page.openAddDialog()}}},[l._v("新增")])],1),s("div",{ref:"page-wrap",staticClass:"page-wrap"},[s("BasicPage",{ref:"page",attrs:{"table-actions":l.tableActions,form:l.form,"form-validate-rules":l.formValidateRules,"add-dialog-title":l.addDialogTitle,"edit-dialog-title":l.editDialogTitle,"edit-dialog-data-api":l.editDialogDataApi,"add-row-api":l.addRowApi,"edit-row-api":l.editRowApi,"delete-row-api":l.deleteRowApi},on:{ajaxFirstPageData:l.ajaxFirstPageData},scopedSlots:l._u([{key:"table",fn:function(){return[s("a-table",{attrs:{"children-column-name":"dealers","row-key":"id",columns:l.columns,"data-source":l.dataSource,pagination:!1,loading:l.loading,scroll:{y:l.pageHeight-64}},scopedSlots:l._u([{key:"action",fn:function(a){return s("div",{},[s(e,{staticClass:"mr-2",attrs:{color:"primary",small:""},on:{click:function(e){return l.$refs.page.openEditDialog(a)}}},[s(t,{attrs:{small:""}},[l._v("mdi-square-edit-outline")]),s("span",[l._v("编辑")])],1),s(e,{attrs:{color:"error",small:""},on:{click:function(e){l.$refs.page.onTableRowDelete(l.find(l.$refs.page.finalTableActions,{_type:"delete"}),a)}}},[s(t,{attrs:{small:""}},[l._v("mdi-delete-outline")]),s("span",[l._v("删除")])],1)],1)}}])})]},proxy:!0}])})],1),s("div",{staticClass:"pagination-wrap d-flex justify-center align-center py-2"},[s("span",[l._v("共 "+l._s(l.pagination.total)+" 条")]),s(i,{attrs:{length:l.pagination.pageCount,"total-visible":7},model:{value:l.pagination.pageNum,callback:function(a){l.$set(l.pagination,"pageNum",a)},expression:"pagination.pageNum"}}),s("span",{staticClass:"mr-2"},[l._v("到第")]),s("div",{staticClass:"mr-2",staticStyle:{width:"60px"}},[s(u,{attrs:{dense:"",outlined:"","hide-details":"",height:"28px",type:"number",autocomplete:"off"},model:{value:l.pagination.toPage,callback:function(a){l.$set(l.pagination,"toPage",a)},expression:"pagination.toPage"}})],1),s("span",{staticClass:"mr-2"},[l._v("页")]),s(e,{attrs:{small:"",color:"primary",disabled:!l.isNumeric(l.pagination.toPage)},on:{click:function(a){l.pagination.pageNum=Number(l.pagination.toPage)}}},[l._v("跳转")])],1)])},b=[];const x=l({setup(){const a=o("page-wrap"),{height:e}=r(a);return{pageHeight:e}},data:()=>({loading:!1,columns:[{dataIndex:"name",title:"零售商姓名",ellipsis:!0},{dataIndex:"merchant.name",title:"所属商户",ellipsis:!0},{dataIndex:"username",title:"用户名",ellipsis:!0},{dataIndex:"phone",title:"手机号",ellipsis:!0},{dataIndex:"status",title:"状态",type:"chip",enumMap:m,customRender(a,e,t){const{label:i,color:l}=m[a];return n("a-tag",{staticClass:l},[i])},ellipsis:!0},{dataIndex:"gmtCreate",title:"创建时间",width:170,ellipsis:!0},{dataIndex:"gmtModified",title:"修改时间",width:170,ellipsis:!0},{title:"操作",fixed:"right",width:180,scopedSlots:{customRender:"action"}}],dataSource:[],pagination:{pageSize:10,total:0,pageCount:0,pageNum:0,toPage:""},tableActions:[{label:"编辑",type:"edit"},{label:"删除",type:"delete",title:'确定删除商户用户 <code class="red--text">{{ name }}</code> ?'}],editDialogDataApi:"/merchant/dealer/info/{{ id }}",addRowApi:"/merchant/dealer/create",editRowApi:"/merchant/dealer/update/{{ id }}",deleteRowApi:"/merchant/dealer/delete/{{ id }}",addDialogTitle:"新增商户用户",editDialogTitle:"编辑商户用户信息",form:[{name:"id",hidden:!0},{name:"name",label:"零售商姓名",required:!0},{name:"username",label:"用户名",required:!0},{name:"phone",label:"手机号"},{name:"password",label:"密码",placeholder:"不填则默认 123456"},{name:"parentId",label:"上级零售商",type:"select",api:"/merchant/dealer/list-selector",attrs:{clearable:!0,filterable:!0}},{name:"status",label:"状态",required:!0,type:"select",items:g,default:"1"}],formValidateRules:{name:[a=>!!a||"请输入用户姓名"],username:[a=>!!a||"请输入用户名"],phone:[a=>!a||(c(a)||"手机号格式不正确")]}}),methods:{find:s.exports.find,isNumeric:d,ajaxData(){const a=this.pagination,e={pageNum:a.pageNum,pageSize:a.pageSize};this.loading=!0,this.$axios({method:"post",url:"/merchant/dealer/list",data:{},params:e}).finally((()=>this.loading=!1)).then((({data:a})=>{const{list:e,pageNum:t,pageSize:i,total:l}=a||{};this.dataSource=e,Object.assign(this.pagination,{pageNum:t,pageSize:i,pageCount:Math.ceil(l/i)||0,total:l})}))},ajaxFirstPageData(){const a=this.pagination,e=a.pageNum;a.pageNum=1,1===e&&this.ajaxData()}},mounted(){this.ajaxData()},watch:{"pagination.pageNum":"ajaxData"},components:{BasicPage:p}}),v={};var w=f(x,h,b,!1,y,"f3661c30",null,null);function y(a){for(let e in v)this[e]=v[e]}var D=function(){return w.exports}();export default D;
